<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Healthy Food Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg1:#f6f6f4;
  --card:#ffffff;
  --accent:#3B7D3B;
  --accent2:#2E8B57;
  --accent3:#e0dac5;
  --muted:#6b6b6b;
  --radius:14px;
  --shadow:0 6px 20px rgba(0,0,0,0.08);
}
*{box-sizing:border-box;}
body{margin:0;padding:12px;font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,sans-serif;background:var(--bg1);display:flex;justify-content:center;}
.wrap{width:100%;max-width:760px;}
.card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;}
.header{padding:16px;display:flex;align-items:center;gap:12px;border-bottom:1px solid #e6e6e6;}
.logo{width:56px;height:56px;border-radius:10px;background:var(--accent);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;}
.title-wrap{flex:1;}
h1{margin:0;font-size:1.2rem;color:var(--accent);}
p.lead{margin:4px 0 0;font-size:0.95rem;color:var(--muted);}
.progress-bar-wrap{height:12px;background:#eef3ef;width:82%;border-radius:999px;margin:14px auto;}
.progress-bar{height:12px;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:999px;transition:width 420ms ease;}
.content{padding:18px;}
.slide{opacity:0;max-height:0;overflow:hidden;transition:opacity 320ms ease,max-height 320ms ease;margin-bottom:12px;}
.slide.active{opacity:1;max-height:1200px;}
.q-card{display:flex;flex-direction:column;gap:12px;}
.q-title{margin:0 0 8px;font-size:1rem;color:#15324b;}
.options{display:grid;gap:10px;}
.option{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;border:1px solid #ececec;cursor:pointer;transition:transform 150ms ease, box-shadow 150ms ease;background:transparent;}
.option:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(11,61,145,0.04);}
.option input{display:none;}
.option .label-text{flex:1;font-size:0.95rem;color:#223;}
.option.selected{background:linear-gradient(180deg,rgba(59,125,59,0.06),rgba(46,139,87,0.02));border-color:rgba(59,125,59,0.12);}
.controls{display:flex;gap:10px;align-items:center;margin-top:12px;flex-wrap:wrap;}
.counter{margin-left:auto;color:var(--muted);font-size:0.9rem;}
.result-screen{padding:12px;}
.result-card{border-radius:12px;padding:16px;color:#fff;margin-top:12px;}
.result-title{font-size:1.05rem;margin:0 0 8px;}
.result-body{margin:0;font-size:0.95rem;}
.btn{display:inline-block;padding:10px 14px;margin-top:12px;border:none;border-radius:10px;background:var(--accent2);color:#fff;font-weight:600;cursor:pointer;transition:0.18s;}
.btn:hover{opacity:0.92;}
.review{margin-top:10px;color:#072034;background:rgba(0,0,0,0.02);padding:12px;border-radius:8px;color:#102;}
.review ul{margin:8px 0 0 18px;padding:0;}
.review li{margin-bottom:10px;font-size:0.95rem;line-height:1.35;}
.review .qtext{display:block;font-weight:600;margin-bottom:6px;color:#15324b;}
.correct{color:#0b3d91;font-weight:700;}
.wrong{color:#b02a2a;font-weight:700;}
.smallmuted{font-size:0.9rem;color:var(--muted);margin-top:6px;}
@media (max-width:520px){.wrap{padding:8px}.title-wrap h1{font-size:1.05rem}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="header">
      <div class="logo">HF</div>
      <div class="title-wrap">
        <h1>Healthy Food Quiz</h1>
        <p class="lead">Test your knowledge of nutrition and healthy eating habits!</p>
      </div>
    </div>
    <div class="progress-bar-wrap">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="content" id="slides"></div>
  </div>
</div>

<script>
// ---------------- DATA ----------------
const levels = [
  { name:'Easy', theme:'Basics', questions:[
      { q:'Which food is rich in vitamin C?', a:['Orange','Bread','Cheese','Rice'], correct:0 },
      { q:'Which food is a whole grain?', a:['Brown rice','White bread','Candy','Ice cream'], correct:0 },
      { q:'Which vegetable is leafy green?', a:['Spinach','Carrot','Potato','Beetroot'], correct:0 },
      { q:'Which is a source of protein?', a:['Egg','Apple','Sugar','Oil'], correct:0 },
      { q:'Which drink is healthiest?', a:['Water','Soda','Energy drink','Sweet tea'], correct:0 }
  ]},
  { name:'Moderate', theme:'Nutrition', questions:[
      { q:'Which mineral is important for bones?', a:['Calcium','Sodium','Chloride','Sugar'], correct:0 },
      { q:'Which vitamin helps vision?', a:['Vitamin A','Vitamin C','Vitamin D','Vitamin K'], correct:0 },
      { q:'Which food has healthy fats?', a:['Avocado','Donut','Fries','Cake'], correct:0 },
      { q:'Which nutrient provides energy?', a:['Carbohydrate','Protein','Vitamin B','Calcium'], correct:0 },
      { q:'Which fruit is high in antioxidants?', a:['Blueberries','White bread','Butter','Candy'], correct:0 }
  ]},
  { name:'Advanced', theme:'Advanced Nutrition', questions:[
      { q:'What is the glycemic index of white bread?', a:['High','Low','Medium','None'], correct:0 },
      { q:'Which nutrient helps repair tissue?', a:['Protein','Sugar','Sodium','Cholesterol'], correct:0 },
      { q:'Which vitamin is fat-soluble?', a:['Vitamin D','Vitamin B','Vitamin C','Vitamin K (water-soluble)'], correct:0 },
      { q:'Which mineral regulates fluid balance?', a:['Potassium','Iron','Zinc','Magnesium'], correct:0 },
      { q:'Which fiber benefits digestion?', a:['Soluble fiber','Trans fat','Saturated fat','Sugar'], correct:0 }
  ]}
];

// ---------------- STATE ----------------
function shuffleArray(arr){ return arr.slice().sort(()=>Math.random()-0.5); }
const questionsState = levels.map(level => ({
  currentQ: 0,
  score: 0,
  questions: level.questions.map(q => ({
    q: q.q,
    a: q.a.slice(),
    correct: q.correct,
    options: shuffleArray(q.a.map((text,i)=>({ text, index:i }))),
    selected: null
  }))
}));
let currentLevel = 0;
const content = document.getElementById('slides');
const progressBar = document.getElementById('progressBar');

// ---------------- FRONT PAGE ----------------
function showLevelSelector(){
  const slide = document.createElement('section');
  slide.className = 'slide active';
  slide.innerHTML = `<div class="result-screen">
    <div class="result-card" style="background:var(--accent)">
      <h3 class="result-title">Select a Level</h3>
      <p class="result-body smallmuted" style="font-weight:600; color:#fff; background:rgba(0,0,0,0.1); padding:4px 6px; border-radius:6px;">
        Choose a difficulty to start the Healthy Food Quiz.
      </p>
      <div style="display:flex;gap:10px;margin-top:12px;flex-wrap:wrap">
        <button class="btn" onclick="startLevel(0)">Easy</button>
        <button class="btn" onclick="startLevel(1)">Moderate</button>
        <button class="btn" onclick="startLevel(2)">Advanced</button>
      </div>
    </div>
  </div>`;
  content.innerHTML = '';
  content.appendChild(slide);
  progressBar.style.width = '0%';
}

// ---------------- QUIZ FLOW ----------------
function startLevel(idx){
  currentLevel = idx;
  questionsState[idx].currentQ = 0;
  questionsState[idx].score = 0;
  questionsState[idx].questions.forEach(q=> q.selected = null);
  createQuestionSlide();
}

function createQuestionSlide(){
  const state = questionsState[currentLevel];
  const qObj = state.questions[state.currentQ];
  const slide = document.createElement('section');
  slide.className = 'slide active';

  let optionsHtml = '';
  qObj.options.forEach(opt => {
    optionsHtml += `<label class="option"><input type="radio" name="q" value="${opt.index}"><div class="label-text">${opt.text}</div></label>`;
  });

  slide.innerHTML = `<div class="q-card">
    <h2 class="q-title">Level ${currentLevel+1} (${levels[currentLevel].name}) - Q${state.currentQ+1}: ${qObj.q}</h2>
    <div class="options">${optionsHtml}</div>
    <div class="controls"><div class="counter">Question ${state.currentQ+1} of ${state.questions.length}</div></div>
  </div>`;

  content.innerHTML = '';
  content.appendChild(slide);
  updateProgressBar();
  bindOptions(slide);
}

function bindOptions(slide){
  const state = questionsState[currentLevel];
  const qObj = state.questions[state.currentQ];
  slide.querySelectorAll('.option').forEach(opt => {
    opt.addEventListener('click', ()=>{
      const input = opt.querySelector('input');
      input.checked = true;
      slide.querySelectorAll('.option').forEach(o=>o.classList.remove('selected'));
      opt.classList.add('selected');
      const chosenOriginalIndex = parseInt(input.value,10);
      qObj.selected = chosenOriginalIndex;
      if(chosenOriginalIndex === qObj.correct) state.score++;
      state.currentQ++;
      if(state.currentQ >= state.questions.length){
        progressBar.style.width = '100%';
      } else { updateProgressBar(); }
      if(state.currentQ < state.questions.length){
        setTimeout(()=> createQuestionSlide(), 160);
      } else {
        setTimeout(()=> showLevelReview(), 240);
      }
    }, { once:true });
  });
}

function updateProgressBar(){
  const state = questionsState[currentLevel];
  const perc = (state.currentQ / state.questions.length) * 100;
  progressBar.style.width = perc + '%';
}

// ---------------- CONFETTI ----------------
function playConfetti(){
  const count = Math.min(window.innerWidth/10,120);
  for(let i=0;i<count;i++){
    const d = document.createElement('div');
    d.style.position='fixed'; d.style.width='8px'; d.style.height='8px';
    d.style.borderRadius='50%'; d.style.background=['#3B7D3B','#2E8B57','#e0dac5'][Math.floor(Math.random()*3)];
    d.style.left=Math.random()*window.innerWidth+'px'; d.style.top='-10px';
    d.style.opacity='0.9'; d.style.zIndex=9999;
    document.body.appendChild(d);
    let fall=0;
    const id=setInterval(()=>{
      fall+=Math.random()*6+2;
      d.style.top=fall+'px';
      d.style.transform=`rotate(${fall*6}deg)`;
      if(fall>window.innerHeight+20){ clearInterval(id); d.remove(); }
    },16);
  }
}

// ---------------- REVIEW / RESULTS ----------------
function showLevelReview(){
  playConfetti();
  const state = questionsState[currentLevel];
  const levelMeta = levels[currentLevel];
  let reviewHtml = '<div class="review"><h4>Review</h4><ul>';
  state.questions.forEach((q,i)=>{
    const selected = q.selected;
    const correct = q.correct;
    const selectedText = (typeof selected==='number')?q.a[selected]:'No answer';
    const correctText = q.a[correct];
    const isCorrect = selected===correct;
    reviewHtml += `<li><span class="qtext">Q${i+1}: ${q.q}</span>
      <div>Your answer: <span class="${isCorrect?'correct':'wrong'}">${selectedText}</span></div>
      ${!isCorrect?`<div>Correct answer: <span class="correct">${correctText}</span></div>`:''}
    </li>`;
  });
  reviewHtml += '</ul></div>';

  const slide = document.createElement('section');
  slide.className = 'slide active';
  slide.innerHTML = `<div class="result-screen">
    <div class="result-card" style="background:var(--accent2)">
      <h3 class="result-title">Level ${currentLevel+1} Summary (${levelMeta.name})</h3>
      <p class="result-body">Score: ${state.score} / ${state.questions.length}</p>
      ${reviewHtml}
      <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
        <button class="btn" id="nextLevelBtn">${currentLevel<levels.length-1?'Next Level':'View Final Score'}</button>
        <button class="btn" id="retryLevelBtn">Retry This Level</button>
        <button class="btn" onclick="window.location.href='index.html'">Back to Hub</button>
      </div>
    </div>
  </div>`;
  content.innerHTML = '';
  content.appendChild(slide);

  document.getElementById('nextLevelBtn').addEventListener('click', function(){
    if(currentLevel<levels.length-1){ currentLevel++; createQuestionSlide(); }
    else { showFinalResults(); }
  }, { once:true });

  document.getElementById('retryLevelBtn').addEventListener('click', ()=>{
    const st = questionsState[currentLevel];
    st.currentQ=0; st.score=0; st.questions.forEach(q=>q.selected=null);
    createQuestionSlide();
  });
}

function showFinalResults(){
  const totalQ = questionsState.reduce((s,lvl)=>s+lvl.questions.length,0);
  const totalScore = questionsState.reduce((s,lvl)=>s+lvl.score,0);
  const slide = document.createElement('section');
  slide.className = 'slide active';
  slide.innerHTML = `<div class="result-screen">
    <div class="result-card" style="background:var(--accent)">
      <h3 class="result-title">Final Results</h3>
      <p class="result-body">
        Easy: ${questionsState[0].score}/${questionsState[0].questions.length}<br>
        Moderate: ${questionsState[1].score}/${questionsState[1].questions.length}<br>
        Advanced: ${questionsState[2].score}/${questionsState[2].questions.length}<br>
        <strong>Total Score: ${totalScore}/${totalQ}</strong>
      </p>
      <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
        <button class="btn" onclick="location.reload()">Retake All</button>
        <button class="btn" onclick="window.location.href='index.html'">Back to Hub</button>
      </div>
    </div>
  </div>`;
  content.innerHTML = '';
  content.appendChild(slide);
  progressBar.style.width='100%';
}

// ---------------- START ----------------
showLevelSelector();
</script>
</body>
</html>
